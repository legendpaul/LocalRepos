<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project Scanner</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%230ea5e9'/%3E%3Cpath d='M18 20h28v6H18zm0 12h28v6H18zm0 12h18v6H18z' fill='%23fff'/%3E%3C/svg%3E" />
  <link rel="stylesheet" href="styles.css" />
  <script src="scripts/main.js" defer></script>
</head>
<body>
  <header class="page-header">
    <div>
      <p class="eyebrow">Serverless Toolkit</p>
      <h1>Project Scanner</h1>
      <p class="lede">
        Inspect code bases from a chosen directory, map duplicated files across projects, and spot uncommitted changes.
      </p>
    </div>
    <div class="badge">Netlify Functions Â· Node 16</div>
  </header>

  <main>
    <section class="panel">
      <div class="panel__header">
        <div>
          <p class="eyebrow">Directory Picker</p>
          <h2>Scan a workspace</h2>
          <p class="hint">Provide a server-accessible path (e.g. <code>C:\SVN</code> or <code>/var/repos</code>).</p>
        </div>
      </div>
      <form id="scan-form" class="form">
        <label class="form__label" for="directory">Directory path</label>
        <div class="form__controls">
          <input id="directory" name="directory" type="text" value="C:\SVN" placeholder="C:\SVN" required />
          <input id="directory-picker-input" type="file" webkitdirectory hidden />
          <button type="button" id="pick-directory" class="ghost">Use picker</button>
          <button type="submit" class="primary">Scan</button>
        </div>
        <p class="form__footnote">
          The optional picker uses the browser's directory access to prefill the path when supported.
        </p>

        <div class="form__controls form__controls--stacked" aria-label="Folder exclusions">
          <p class="form__label">Skip library folders</p>
          <div class="pill-checkboxes" id="exclude-folders">
            <label class="pill-checkbox">
              <input type="checkbox" name="exclude-folder" value="Library" checked />
              <span>Unity Library</span>
            </label>
            <label class="pill-checkbox">
              <input type="checkbox" name="exclude-folder" value="PackageCache" checked />
              <span>Unity PackageCache</span>
            </label>
            <label class="pill-checkbox">
              <input type="checkbox" name="exclude-folder" value="packages" />
              <span>Packages</span>
            </label>
            <label class="pill-checkbox">
              <input type="checkbox" name="exclude-folder" value="vendor" />
              <span>Vendor</span>
            </label>
            <label class="pill-checkbox">
              <input type="checkbox" name="exclude-folder" value="Pods" />
              <span>CocoaPods</span>
            </label>
          </div>
          <label class="form__label" for="exclude-custom">Custom folder names to ignore</label>
          <input
            id="exclude-custom"
            name="exclude-custom"
            type="text"
            placeholder="Enter folder names, comma separated (e.g., .nuget, temp, cache)"
          />
          <p class="form__footnote">Ignored names are matched anywhere in the path so cached dependencies stay out of the scan.</p>
        </div>
      </form>
      <div id="status" class="status status--idle">Waiting to scan...</div>
    </section>

    <section class="panel" id="filters" hidden>
      <div class="panel__header">
        <div>
          <p class="eyebrow">Search &amp; filter</p>
          <h2>Refine results</h2>
          <p class="hint">Search by project name, path, technology, or identifier counts.</p>
        </div>
      </div>
      <div class="filters">
        <label class="form__label" for="search">Search</label>
        <input id="search" name="search" type="search" placeholder="Search projects or technologies" />
        <div class="filters__row">
          <div class="filters__group">
            <div class="filters__group-header">
              <label class="form__label" for="include-technology-filter">Include technologies</label>
              <p class="small">Projects must include every selected technology.</p>
            </div>
            <select id="include-technology-filter" name="include-technology-filter" multiple size="6"></select>
          </div>
          <div class="filters__group">
            <div class="filters__group-header">
              <label class="form__label" for="exclude-technology-filter">Hide technologies</label>
              <p class="small">Projects using any selected technology will be hidden.</p>
            </div>
            <select id="exclude-technology-filter" name="exclude-technology-filter" multiple size="6"></select>
          </div>
        </div>
      </div>
    </section>

    <section class="grid" id="results" aria-live="polite"></section>

    <section class="panel" id="duplicates" hidden>
      <div class="panel__header">
        <p class="eyebrow">Cross-project links</p>
        <h2>Identical code segments</h2>
      </div>
      <div id="duplicate-list" class="list"></div>
    </section>
    <section class="panel" id="relationships" hidden>
      <div class="panel__header">
        <div>
          <p class="eyebrow">Relationship map</p>
          <h2>Project links</h2>
          <p class="hint">Visualize shared code and references between projects. Click a node for details.</p>
        </div>
      </div>
      <div class="relationships">
        <div class="relationships__graph" role="img" aria-label="Project relationship graph">
          <svg id="relationship-graph" viewBox="0 0 900 480"></svg>
        </div>
        <aside class="relationships__sidebar">
          <div class="legend">
            <div class="legend__item">
              <span class="legend__swatch legend__swatch--duplicate"></span>
              <span>Shared files</span>
            </div>
            <div class="legend__item">
              <span class="legend__swatch legend__swatch--reference"></span>
              <span>References</span>
            </div>
          </div>
          <div id="relationship-details" class="relationship-details">
            <p class="small">Select a project node to see technologies, git state, and quick navigation.</p>
          </div>
        </aside>
      </div>
    </section>
  </main>
</body>
</html>
